<!DOCTYPE html>
<html lang="th">

<head>
    <title>‡∏†‡∏π‡∏ò‡∏£‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡πà</title>
    <link rel="icon" type="image/png" href="favicon.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Kanit&display=swap">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <img src="logo600px.png" class="mx-auto d-block" alt="‡∏†‡∏π‡∏ò‡∏£‡πÄ‡∏î‡∏•‡∏¥‡πÄ‡∏ß‡∏≠‡∏£‡∏µ‡πà">
    <form id="completeOrder" name="completeOrder" action="https://script.google.com/macros/s/AKfycbwz2eb4u-xXhr1ih3Ay3uFoIm1LYFJHKF9vd7U0Y-38389vZmTmLPJCeCvnKmhLlPxnZQ/exec" method="post">
        <div class="form-group row">
            <label class="col-4">üíµ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</label>
            <div>
                <div>
                    <input name="payment" id="payment_0" type="radio" onchange="document.getElementById('transferBlock').style.display= 'none';" value="‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô" required="required">
                    <label for="payment_0">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î</label>
                </div>
                <div>
                    <input name="payment" id="payment_1" type="radio" onchange="document.getElementById('transferBlock').style.display= 'none';" value="‡πÇ‡∏≠‡∏ô‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≥‡∏ô‡∏ß‡∏ô">
                    <label for="payment_1">‡πÇ‡∏≠‡∏ô</label>
                </div>
                <div>
                    <input name="payment" id="payment_2" type="radio" onchange="document.getElementById('transferBlock').style.display= 'flex';document.getElementById('transfer').value = ''; document.getElementById('transfer').focus();" value="‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÅ‡∏•‡∏∞‡πÇ‡∏≠‡∏ô">
                    <label for="payment_2">‡πÄ‡∏á‡∏¥‡∏ô‡∏™‡∏î‡πÅ‡∏•‡∏∞‡πÇ‡∏≠‡∏ô</label>
                </div>
            </div>
        </div>
        <div id="transferBlock" class="form-group row" style="display: none;">
            <label for="transfer" class="col-4">üí∞‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏≠‡∏î‡πÇ‡∏≠‡∏ô</label>
            <div class="col-8">
                <input id="transfer" name="transfer" style="width: 100%" type="text" pattern="^\d[\d\.\+\-]*" value="0" required="required" aria-describedby="transferHelpBlock">
                <span id="transferHelpBlock" class="form-text text-muted">‡∏£‡∏∞‡∏ö‡∏∏‡∏¢‡∏≠‡∏î‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÇ‡∏≠‡∏ô</span>
            </div>
        </div>
        <div class="form-group row">
            <label for="location" class="col-4">üéØ‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</label>
            <div class="col-8">
                <input id="location" name="location" style="width: 100%" type="text" required="required" aria-describedby="locationHelpBlock" readonly>
                <span id="locationHelpBlock" class="form-text text-muted">üì° ‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô GPS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥
                    üõ∞Ô∏è</span>
            </div>
        </div>
        <div class="row justify-content-center">
            <button type="button" class="btn btn-info btn-lg" onclick="getLocation();">‡∏Ç‡∏≠‡∏Ñ‡πà‡∏≤‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÉ‡∏´‡∏°‡πà</button>
            <button name="submit" type="submit" class="btn btn-primary btn-lg btn-space">üì§‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
        <input type="hidden" id="rider" name="rider" value="">
        <input type="hidden" id="row" name="row" value="">
        <input type="hidden" id="tel" name="tel" value="">
    </form>
    <script>
        document.onreadystatechange = () => {
            if (document.readyState === "complete") {
                let queryString = decodeURIComponent(window.location.search);
                queryString = queryString.replace("?liff.state=", "");

                const params = new Proxy(new URLSearchParams(queryString), {
                    get: (searchParams, prop) => searchParams.get(prop),
                });

                document.getElementById("rider").value = params.rider;
                document.getElementById("row").value = params.row;
                document.getElementById("tel").value = params.tel;
                getLocation();
            }
        };

        function getLocation() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(showPosition, getLocationError, { timeout: 4000, enableHighAccuracy: true });
            } else {
                getLocationError();
            }
        }

        function getLocationError() {
            document.getElementById("location").value = "‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô GPS";
        }

        function showPosition(position) {
            if (document.getElementById("location").value === position.coords.latitude + "," + position.coords.longitude) {
                document.getElementById('locationHelpBlock').innerText = "üéØ ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡πà‡∏≤‡∏û‡∏¥‡∏Å‡∏±‡∏î‡πÄ‡∏î‡∏¥‡∏°";
            } else {
                document.getElementById("location").value = position.coords.latitude + "," + position.coords.longitude;
                document.getElementById('locationHelpBlock').innerText = "üì° ‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô GPS ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏°‡πà‡∏ô‡∏¢‡∏≥ üõ∞Ô∏è";
            }
        }

    </script>
</body>

</html>